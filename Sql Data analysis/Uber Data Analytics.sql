-- Analysis of Uber's Operational Data --use uber_analysis-- City-Level Performance Optimization ---- Which are the top 3 cities where Uber should focus more on driver recruitment based on key metrics such as demand high cancellation rates and driver ratings? --select top 3  start_city,count(*) as total_rides_request,avg(case when ride_status = 'completed' then rating else null end) as avg_completed_ride_rating,sum(case when ride_status = 'canceled' then 1 else 0 end) as cancelled_rides,cast(sum(case when ride_status = 'canceled' then 1 else 0 end)*1.0/count(*) as decimal(5,4)) as cacelleton_ratefrom ridesgroup by start_cityorder by total_rides_request desc-- Revenue Leakage Analysis ---- How can you detect rides with fare discrepancies or those marked as "completed" without any corresponding payment? --select r.*, p.fare from rides as rleft join payments as pon r.ride_id = p.ride_idwhere r.ride_status = 'completed' and p.fare is null and r.fare is not null-- Cancellation Analysis ---- What are the cancellation patterns across cities and ride categories? How do these patterns correlate with revenue from completed rides? --select r.start_city, r.payment_method ,count(*) as total_rides,sum( case when r.ride_status = 'canceled' then 1 else 0 end) as cancelled_rides,cast(sum(case when r.ride_status = 'canceled' then 1 else 0 end)*1.0/count(*) as decimal(5,4)) as cancelletion_rate,sum(case when r.ride_status = 'completed' and p.fare is not null then p.fare else 0 end) as completed_revenuefrom rides as rleft join payments as pon r.ride_id = p.ride_idgroup by r.start_city, r.payment_methodorder by r.start_city, cancelletion_rate desc-- Cancellation Patterns by Time of Day ---- Analyze the cancellation patterns based on different times of day. Which hours have the highest cancellation rates, and what is their impact on revenue? --select casewhen datepart(hour, start_time) between 0 and 4 then 'late night'when datepart(hour, start_time) between 5 and 11 then 'morning'when datepart(hour, start_time) between 12 and 16 then 'afternoon'when datepart(hour, start_time) between 17 and 21 then 'evening'when datepart(hour, start_time) between 22 and 23 then 'night'end  as time_of_day,count(*) as total_rides,sum( case when ride_status = 'canceled' then 1 else 0 end) as cancelled_rides,cast(sum(case when ride_status = 'canceled' then 1 else 0 end)*1.0/count(*) as decimal(5,4)) as cancelletion_ratefrom ridesgroup by casewhen datepart(hour, start_time) between 0 and 4 then 'late night'when datepart(hour, start_time) between 5 and 11 then 'morning'when datepart(hour, start_time) between 12 and 16 then 'afternoon'when datepart(hour, start_time) between 17 and 21 then 'evening'when datepart(hour, start_time) between 22 and 23 then 'night'endorder by cancelletion_rate desc;-- Seasonal Fare Variations ---- How do fare amounts vary across different seasons? Identify any significant trends or anomalies in fare distributions. --select case  when datepart(month, ride_date) in (12, 1, 2) then 'winter'  when datepart(month, ride_date) in (3, 4, 5) then 'spring'  when datepart(month, ride_date) in (6, 7, 8) then 'summer'  when datepart(month, ride_date) in (9, 10, 11) then 'autumn'  end as season,count(*) as completed_rides,avg(fare) as avg_fare,sum(fare) as total_fare,min(fare) as min_fare,max(fare) as max_farefrom rideswhere ride_status = 'completed'and fare is not nullgroup by    case   when datepart(month, ride_date) in (12, 1, 2) then 'winter'   when datepart(month, ride_date) in (3, 4, 5) then 'spring'   when datepart(month, ride_date) in (6, 7, 8) then 'summer'   when datepart(month, ride_date) in (9, 10, 11) then 'autumn'   endorder by avg_fare desc;-- Average Ride Duration by City ---- What is the average ride duration for each city? How does this relate to customer satisfaction? --select start_city,count(*) as completed_rides,avg(ride_duration_min) as avg_ride_duration_min,min(ride_duration_min) as min_duration_min,max(ride_duration_min) as max_duration_minfrom rideswhere ride_status = 'completed'  and ride_duration_min is not null  and ride_duration_min > 0group by start_cityorder by avg_ride_duration_min desc;-- Index for Ride Date Performance Improvement ---- How can query performance be improved when filtering rides by date? --